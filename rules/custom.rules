# 1. БЛОКИРОВКА — сначала drop/reject
drop icmp any any -> $HOME_NET any (msg:"ICMP blocked"; itype:8; icode:0; sid:1000001; rev:1;)
drop icmp any any -> $HOME_NET any (msg:"All ICMP blocked"; sid:1000002; rev:1;)

# 2. РАЗРЕШЕНИЕ — потом pass
pass http any any -> any any (msg:"HTTP allowed"; sid:1000003; rev:1;)
pass dns any any -> any any (msg:"DNS allowed"; sid:1000004; rev:1;)

# 3. ЛОГИРОВАНИЕ — только если не сработали другие (необязательно)
# alert icmp any any -> $HOME_NET any (msg:"ICMP detected (should be blocked)"; sid:1000000; rev:1;)

